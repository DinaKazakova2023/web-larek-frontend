# Проектная работа "Веб-ларек"
Интернет-магазин с товарами для веб-разработчиков - Web-ларек. В нем можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.

# Структура
Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура проекта

Проект реализован на TS с использованием архитектурного паттерна MVP (Model-View-Presenter)(решила по совету выбрать MVP), делит код на три слоя:

1) Model (слой данных) - модель отвечает за данные и бизнес-логику приложения (хранит данные; выполняет операции с данными: добавление, удаление, изменение, чтение; обрабатывает бизнес-логику и правила; не зависит от пользовательского интерфейса (View) или пользовательских действий (Controller));
2) View (слой отображения) - отвечает за отображение данных пользователю (отвечает за показ карточек товаров, корзины и т. д.);
3) Presenter (презентер) - отвечает за взаимодействие данных и представления, описывая логику приложения.

# Базовый код
## Класс Api
Содержит в себе базовую логику отправки запросов.

constructor() - принимает url сервера, по которому будут совершаться запросы и общие опции для этих запросов.

Поля:

serverUrl - базовый адрес сервера
requestHeaders - объект с заголовками запросов

Методы:

get - получить данные с сервера
post - используется для отправки POST-запросов на указанный URI с переданными данными
handleResponse - защищенный метод, в случае успеха выполнения запроса возвращает объект в виде json. В случае неуспеха - статус и текст ошибки

## Класс Component
Представляет собой абстрактный базовый класс для создания интерфейсных компонентов.

constructor(container: HTMLElement) - принимает элемент контейнера, в который будет помещен компонент

Методы:

toggleClass - переключает класс у элемента
setText - устанавливает текст элементу
setImage - устанавливает изображение элементу
setVisible - отображает элемент
setHidden - скрывает элемент
setDisabled - устанавливает состояние блокировки элемента
render - возвращает корневой DOM-элемент

## Класс EventEmitter
Используется как брокер событий. Он позволяет объектам (наблюдателям) подписываться на события и реагировать на них, когда они происходят, что полезно для создания гибкой архитектуры приложений, разделения слоя данных и представления.

constructor() - инициализирует брокер событий

Поля:

events: Map - основное хранилище всех событий и их обработчиков

Методы:

on - устанавливает обработчик на событие
off - удаляет обработчик для указанного события
onAll - подписывает обработчик на все события
offAll -  удаляет обработчики событий
emit - инициализация события
trigger - возвращает функцию, которая активирует указанное событие при её вызове

## Класс View
Этот класс расширяет базовый класс Component и добавляет в него возможность взаимодействия с брокером событий через поле events. 

constructor() - вызывает конструктор родительского класса Component, передавая ему container, и инициализирует поле events, которое будет использоваться для работы с событиями.

Методы:
Полностью наследуются от класса Component

# Общий родительский класс Form
Класс для для работы с формами

Поля:

actionButton - элемент кнопки для сабмита формы
errorsContainer - элемент для вывода ошибок валидации
valid - валидность формы

Методы:

inputChange - обрабатывает события ввода
set errors - устанавливает текст ошибок валидации формы
render - рендерит компонент формы, используя переданное состояние

# Общий родительский класс Modal
Класс для модальных окон.

constructor() - принимает на вход HTMLElement и IEvents для работы с событиями

Поля:

content - наполнение модального окна
closeModal - кнопка закрытия модального окна

Методы: 

open - открывает модальное окно
close - закрывает модальное окно
set content - меняет содержимое модального окна

# Слой данных

## Класс StoreData
Отвечает за хранение информации и логику работы с данными товаров.

constructor(protected events: IEvents) - принимает при создании брокер событий

Поля:

products — массив товаров
currentProduct — товар, который в данный момент открыт для просмотра
orderDetails — данные текущего заказа
formValidationErrors — объект с ошибками валидации формы
basket — объект корзины, содержащий добавленные товары и их общую стоимость

Методы:

setProducts - меняет текущий массив товаров новым и эмитит событие products:change
setCurrentProduct - устанавливает текущий открытый товар и эмитит событие currentProduct:change
setPaymentMethod - изменяет способ оплаты на переданный
validateOrderForm - проверяет корректность заполнения данных заказа
resetOrderDetails - очищает текущий заказ
addProductToBasket - добавляет указанный товар в корзину и эмитит событие basket:change
isInBasket - проверяет, находится ли переданный товар в корзине
removeProductFromBasket - удаляет указанный товар из корзины и эмитит событие basket:change
clearBasket - полностью очищает корзину и эмитит событие basket:change

# Слой отображения

## Класс Page
Реализует отображение главной страницы с каталогом товаров, а также счетчика товаров, добавленных в корзину.

Поля:

catalog - элемент каталога
wrapper - элемент обертки
counter - элемент счетчика
basket - элемент корзины

Методы:

set counter - устанавливает счетчик элемента
set catalog - устанавливает каталог элемента
set locked -  заблокировать/разблокировать элемент

## Класс ProductCard
Карточка товара.

Поля:

category - категория товара
title - название карточки
description - описание карточки
image - изображение карточки
price - цена товара в карточке
button - кнопка

Методы:

id - установливает и получает id карточки
category - меняет содержимое категории товара
title - название карточки
description - меняет содержимое заголовка
image - меняет изображение
price - меняет цену
button - устанавливает текст на кнопке карточки

## Класс OrderForm
Наследуется от класса Form, упрвляет отображением полей ввода формы и переключения способа оплаты.

Поля:

paymentCard - кнопка выбора оплаты картой
paymentCash - кнопка выбора оплаты при получении
address - поле ввода для адреса

Методы:

set payment - установливает метод оплаты
set address - установливает значение поля адреса

## Класс Contacts
Компонент формы контактов.

Поля:

email - поле ввода с почтой
phone - поле ввода с телефоном

Методы:

set email - устанавливает значение поля почты
set phone - устанавливает значение поля телефона

## Класс Basket
Отвечает за отображение корзины товаров. 

Поля:

template - элемент шаблона корзины
list - элемент содержимого корзины (карточек товаров)
total - элемент суммы товаров в корзине
button - элемент кнопки оформления заказа в корзине

Методы:

items — возвращает список товаров в корзине
total — рассчитывает общую стоимость корзины

## Класс Success
Реализует отображение содержимого модального окна успешного выполнения заказа.

Поля:

total - элемент с итоговой стоимостью заказа
close - элемент кнопки закрытия модального окна

Методы:

set total - устанавливает итоговую стоимость

# Презентер
Отвечает за взаимодействие компонентов.
Взаимодействие осуществляется за счет событий проходящих в брокере событий и отслеживании этих событий:

items:change - изменение массива товаров
formErrors:change - изменение в списке ошибок валидации формы
preview:change - изменение выбранного товара в модальном окне
basket:change - изменение списка товаров корзины
order:open - открытие формы заказа
modal:open - открытие модального окна
modal:close - закрытие модального окна
card:select - выбор карточки
order:open - открытие окна оформления заказа
order:submit - отправка формы со способом платежа и адресом
contacts:submit - отправка формы с контактными данными



## Типы данных

interface IOrder {
    payment: PaymentMethod; // способ оплаты
    address: string; // адрес
    email: string; // эл.почта
    phone: string; // телефон
}

interface IProductCatalog {
 id: string; // Уникальный идентификатор товара
 description: string; // Описание товара
 image: string; // Ссылка на изображение
 title: string; // Название товара
 category: ICategoryProduct; // Категория товара
 price: number | null; // Цена товара (число или null если цена не указана)
}

# Принцип работы онлайн-магазина "Веб-ларек" (и его страницы)

## Главная страница
Содержит каталог товара. 
При нажатии на карточку товара - открывается модальное окно с детальной информацией о товаре.
Так же содержит икноку корзину, при клике на которую открывается корзина.

## Просмотр товара
Информация о товаре.
Кнопка "купить" (добавляет товар в корзину)
При нажатии на кнопку "убрать" товар удаляется из корзины.

## Просмотр корзины
Название товара, цена, кнопка удалить и кнопка оформить.
Общая сумма товаров.

## Оформление товара
1 шаг:
выбор способа оплаты
ввод адреса доставки
(если адрес доставки не введен, появляется сообщение об ошибке).

2 шаг:
ввод почты и телефона
(так же ошибка, если поля не заполнены)
при нажатии на кнопку "оплатить" появляется сообщение об успешной оплате и товары удаляются из корзины.